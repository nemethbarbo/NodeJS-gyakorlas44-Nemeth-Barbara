<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NodeJS - Users - CRUD</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .container {
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-5 text-center">Felhasználók</h1>
        <form id="newUserForm" class="mb-4 w-50">
            <h2>Új felhasználó létrehozása</h2>
            <div class="mb-3">
                <label for="userName" class="form-label">Név</label>
                <input type="text" class="form-control" name="userName" id="userName" placeholder="Kérem adja meg a felhasználó nevét!!!" required>
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="text" class="form-control" name="email" id="email" placeholder="Kérem adja meg a felhasználó email címét!" required>
            </div>
            <div class="mb-3">
                <label for="birthDate" class="form-label">Születési idő</label>
                <input type="date" class="form-control" name="birthDate" id="birthDate" required>
            </div>
            <div class="mb-3">
                <label for="status" class="form-label">Állapot</label>
                <br>
                <input type="checkbox" name="status" id="status" value="true" >
                <label for="status">Aktív</label>
                <input type="checkbox" name="status" id="status" value="false" >
                <label for="status">Inaktív</label>
            </div>
            <button type="submit" class="btn btn-primary"><i class="fas fa-plus"></i> Létrehozás</button>
            </form>

            <h2>Felhasználók listája</h2>
            <table id="usersTable" class="table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Név</th>
                        <th>Email</th>
                        <th>Születési idő</th>
                        <th>Állapot</th>
                    </tr>
                </thead>
            <tbody>
                <!--axios segítségével tölti be a jsonből-->
            </tbody>
        </table>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const tableBody = document.querySelector('#usersTable tbody');
        const formNewUser = document.getElementById('newUserForm');

        // Felhasználók betöltése
        function loadUsers(){
            axios.get('/users')
                .then(response=> {
                    const users = response.data;
                    tableBody.innerHTML = '';

                    users.forEach(user => {
                        const row = document.createElement('tr');   
                        row.innerHTML = `           
                        <td>${user.id}</td>
                        <td>${user.userName}</td>
                        <td>${user.email}</td>
                        <td>${user.birthDate}</td>
                        <td>${user.status}</td>
                        <td>
                        <button class="btn btn-warning editBtn" data-id="${user.id}"><i class="fas fa-edit"></i> Szerkesztés</button>
                        <button class="btn btn-danger deleteBtn" data-id="${user.id}"><i class="fas fa-trash"></i> Törlés</button>
                        </td>
                        `;
                        tableBody.appendChild(row);     // tableBodyhoz hozzáfűzi a sorokat
                    });
                })
                .catch(error=>{
                    console.error('Hiba történt: ', error);
                });
        }



        loadUsers();
    </script>
</body>